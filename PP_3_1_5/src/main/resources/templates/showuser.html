<!DOCTYPE html>
<html lang="en">
<head>
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <meta charset="UTF-8">
    <title>User Information</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/css/bootstrap.min.css" rel="stylesheet"
          integrity="sha384-EVSTQN3/azprG1Anm3QDgpJLIm9Nao0Yz1ztcQTwFspd3yD65VohhpuuCOmLASjC" crossorigin="anonymous">
</head>
<body>

<!--Navbar-->
<header>
    <nav class="navbar navbar-dark bg-dark p-0 shadow">
        <div class="nav-item text-left text-white px-3">
            <span class="fw-bold" id="userEmail"></span>
            <span>with roles:</span>
            <span id="userRoles"></span>
        </div>
        <ul class="navbar-nav mr-auto">
            <li class="nav-item text-nowrap">
                <a class="nav-link px-3" href="/logout">Logout</a>
            </li>
        </ul>
    </nav>
</header>

<div class="container-fluid mt-3">

    <!--Sidebar-->
    <div class="row">
        <div class="col-md-2 px-0">
            <div class="d-flex flex-column flex-shrink-0 p-0 text-white bg-dark">
                <ul class="nav nav-pills flex-column mb-auto">
                    <li class="nav-item">
                        <a href="#" class="nav-link active" id="loadUserInfo">User</a>
                    </li>
                </ul>
            </div>
        </div>

        <!--User info-->
        <div class="col-md-10 bg-light">
            <div class="tab-content">
                <div class="tab-pane fade show active" id="userInfo" role="tabpanel">
                    <div class="container-fluid">
                        <h2>User Information Page</h2>
                        <div class="card">
                            <div class="container-fluid px-0 bg-light border">
                                <h5 class="card-header">About user</h5>
                            </div>

                            <div class="container-fluid mt-4">
                                <div class="table-responsive">
                                    <table class="table table-striped bg-white" id="userTable">
                                        <thead>
                                        <tr>
                                            <th>ID</th>
                                            <th>First Name</th>
                                            <th>Last Name</th>
                                            <th>Email</th>
                                            <th>Role</th>
                                        </tr>
                                        </thead>
                                        <tbody>
                                        <!-- Data will be loaded here by JavaScript -->
                                        </tbody>
                                    </table>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/js/bootstrap.bundle.min.js" integrity="sha384-MrcW6ZMFYlzcLA8Nl+NtUVF0sA7MsXsP1UyJoMp4YLEuNSfAP+JcXn/tWtIaxVXM" crossorigin="anonymous"></script>
<script>
    // Function to load user data and display it in the table
    function loadUserData() {
        fetch('/user') // Replace with your REST endpoint
            .then(response => response.json())
            .then(user => {
                // Set navbar user email and roles
                document.getElementById('userEmail').textContent = user.email;
                document.getElementById('userRoles').textContent = user.roles.join(', ');

                // Populate user table
                const table = document.getElementById('userTable').getElementsByTagName('tbody')[0];
                const row = table.insertRow();
                row.insertCell(0).textContent = user.id;
                row.insertCell(1).textContent = user.username;
                row.insertCell(2).textContent = user.lastname;
                row.insertCell(3).textContent = user.email;
                row.insertCell(4).textContent = user.roles.join(', ');
            })
            .catch(error => console.error('Error:', error));
    }

    // Event listener for the User link in the sidebar
    document.getElementById('loadUserInfo').addEventListener('click', function(event) {
        event.preventDefault();
        loadUserData();
    });

    // Load user data on page load
    document.addEventListener('DOMContentLoaded', loadUserData);
</script>

</body>
</html>